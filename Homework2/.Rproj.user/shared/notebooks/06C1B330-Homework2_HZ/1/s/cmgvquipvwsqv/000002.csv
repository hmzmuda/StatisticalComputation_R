"0","#import data set from Givens et al. "
"0","data.oil <- read.table(""oilspills.dat"",header = TRUE)"
"0","#likelihood function"
"0","l <- function(N, a, bi1, bi2){"
"0","  result <- sum(N*log(a[1]*bi1+a[2]*bi2)) - sum((a[1]*bi1+a[2]*bi2)) - sum(log(factorial(N)))"
"0","  return(result)"
"0","}"
"0","#derivative of the likelihood function"
"0","dl <- function(N, a, b){"
"0","  result1 <- sum((N*b[1])/(a[1]*b[1] + a[2]*b[2])-sum(b[1]))"
"0","  result2 <- sum((N*b[2])/(a[1]*b[1] + a[2]*b[2])-sum(b[2]))"
"0","  return(matrix(data = list(result1,result2), nrow = 2, ncol = 1, dimnames = NULL))"
"0","}"
"0","#double derivative of the likelihood function"
"0","d2l <- function(N, a, b){"
"0","  result11 <- sum(-(N*b[1]^2)/(a[1]*b[1] + a[2]*b[2])^2)#1st row, 1st col"
"0","  result12 <- sum(-(N*b[1]*bi2)/(a[1]*b[1] + a[2]*b[2])^2)#1st row,2nd col"
"0","  result22 <- sum(-(N*b[2]^2)/(a[1]*b[1] + a[2]*b[2])^2)#2nd row, 2nd col"
"0","  result21 <- sum(-(N*b[2]*b[1])/(a[1]*b[1] + a[2]*b[2])^2)#2nd row, 1st col"
"0","  return(matrix(data = list(result11,result21,result12,result22), nrow = 2, ncol = 2, dimnames = NULL))"
"0","}"
"0","#Fisher Information"
"0","I <-  function(N, a, b){"
"0","  result11 <- sum(mean((N*b[1]^2)/(a[1]*b[1] + a[2]*b[2])^2))#1st row, 1st col"
"0","  result12 <- sum(mean((N*b[1]*bi2)/(a[1]*b[1] + a[2]*b[2])^2))#1st row,2nd col"
"0","  result22 <- sum(mean((N*b[2]^2)/(a[1]*b[1] + a[2]*b[2])^2))#2nd row, 2nd col"
"0","  result21 <- sum(mean((N*b[2]*b[1])/(a[1]*b[1] + a[2]*b[2])^2))#2nd row, 1st col"
"0","  return(matrix(data = list(result11,result21,result12,result22), nrow = 2, ncol = 2, dimnames = NULL))"
"0","}"
"0",""
"0","new.oil <- function(N,a,b,l,dl,d2l,tol){"
"0","  n <- length(N)"
"0","  i <- 1"
"0","  a0 <- matrix(c(1,1),nrow = 2,ncol = 1)"
"0","  for(i in 1:n){"
"0","    a = a0 - dl(N,a,b)/d2l(N,a,b)"
"0","    if(abs(a-a0) <= tol){"
"0","      output.alpha <- a"
"0","      return(a)"
"0","    }"
"0","    a0 <- a"
"0","  }"
"0","}"
"0",""
