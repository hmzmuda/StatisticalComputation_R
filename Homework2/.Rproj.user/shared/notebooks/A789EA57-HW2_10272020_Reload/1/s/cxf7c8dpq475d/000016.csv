"0","library(MASS)"
"0","#call the galaxies dataset"
"0","data(galaxies)"
"0","x <- galaxies"
"0","n <- length(x)"
"0","#make an estimation for the mu, sigma, and alpha variables. Can use k clustering based on the remark"
"0","kCluster <- kmeans(x,2)$cluster"
"0","mu1 <- mean(x[kCluster == 1])"
"0","mu2 <- mean(x[kCluster == 2])"
"0","sigma1 <- sd(x[kCluster == 1])"
"0","sigma2 <- sd(x[kCluster == 2])"
"0","alpha <- sum(kCluster == 1)/length(kCluster) #Make alpha based on the first mixture"
"0","#Other variables"
"0","i <- 2 #number of mixture models (two-mixture model)"
"0","tol <- 1e-10 #tolerance for the EM Algorithm"
"0","#Calculate Q"
"0","#initalize Q"
"0","Q <- 0"
"0","Q[2] <- sum(log(alpha*dnorm(x,mu1,sqrt(sigma1)))) + sum(log((1-alpha)*dnorm(x,mu2,sqrt(sigma2))))"
"0","#E step: Compute Q(theta | theta^t) where theta = (alpha,mu1,mu2,sig1,sig2)"
"0","while(abs(Q[i]-Q[i-1])>=tol){"
"0","  #Find the conditional probability for each mixture model"
"0","  mix1 <- alpha*dnorm(x,mu1,sigma1)"
"0","  mix2 <- (1-alpha)*dnorm(x,mu2,sigma2)"
"0","  totalMix <- mix1 + mix2"
"0","  cp1 <- mix1/totalMix#Conditional Probability for mixture 1"
"0","  cp2 <- mix2/totalMix#Conditional probability for mixture 2"
"0","  #M step"
"0","  alpha <- sum(cp1)/n"
"0","  mu1 <- sum(x*cp1)/sum(cp1)"
"0","  mu2 <- sum(x*cp2)/sum(cp2)"
"0","  sigma1 <- sqrt(sum(((x-mu1)^2)*cp1)/sum(cp1))"
"0","  sigma2 <- sqrt(sum(((x-mu2)^2)*cp2)/sum(cp2))"
"0","  #update probability values"
"0","  cp1 <- alpha"
"0","  cp2 <- 1-alpha"
"0","  #update counter"
"0","  i <- i + 1"
"0","  #Return E-step, unless stopping criteria has been met"
"0","  Q[i] <- sum(log(totalMix))"
"0","}"
"0","theta <- list(""alpha"" = alpha, ""mu1"" = mu1, ""mu2"" = mu2, ""sigma1"" = sigma1,""sigma"" = sigma2)"
"0","print(theta)"
"1","$alpha
"
"1","[1]"
"1"," 0.2547571"
"1","
"
"1","
"
"1","$mu1
"
"1","[1]"
"1"," 19276.54"
"1","
"
"1","
"
"1","$mu2
"
"1","[1]"
"1"," 21358.59"
"1","
"
"1","
"
"1","$sigma1
"
"1","[1]"
"1"," 8189.965"
"1","
"
"1","
"
"1","$sigma
"
"1","[1]"
"1"," 1890.294"
"1","
"
"1","
"
"0","hist(x, prob = T, breaks = 20, xlab = ""Velocities (km/sec)"", main = ""Mixture Model Based on Galaxies Dataset"")"
