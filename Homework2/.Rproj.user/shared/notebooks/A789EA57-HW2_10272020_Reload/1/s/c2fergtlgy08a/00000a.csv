"0","#import data set from Givens et al."
"0","data.oil <- read.table(""oilspills.dat"",header = TRUE)"
"0",""
"0","#likelihood function"
"0","l <- function(N, theta.old){"
"0","  result <- sum(N*log(theta.old)) - sum(theta.old) - sum(log(factorial(N)))"
"0","  return(result)"
"0","}"
"0","#derivative of the likelihood function"
"0","dl <- function(N, b1, b2, theta.old){"
"0","  result1 <- sum((N*b1)/(theta.old)-sum(b1))"
"0","  result2 <- sum((N*b2)/(theta.old)-sum(b2))"
"0","  output <- as.numeric(list(result1,result2))"
"0","  return(matrix(data = output, nrow = 2, ncol = 1, dimnames = NULL))"
"0","}"
"0","#double derivative of the likelihood function"
"0","d2l <- function(N, b1, b2, theta.old){"
"0","  result11 <- sum(-(N*b1^2)/(theta.old)^2)#1st row, 1st col"
"0","  result12 <- sum(-(N*b1*b2)/(theta.old)^2)#1st row,2nd col"
"0","  result22 <- sum(-(N*b2^2)/(theta.old)^2)#2nd row, 2nd col"
"0","  result21 <- sum(-(N*b2*b1)/(theta.old)^2)#2nd row, 1st col"
"0","  output <- as.numeric(list(result11,result21,result12,result22))"
"0","  return(matrix(data = output, nrow = 2, ncol = 2, dimnames = NULL))"
"0","}"
"0","#Fisher Information"
"0","I <- function(N, b1, b2, theta.old){"
"0","  result11 <- sum(mean((N*b1^2)/(theta.old)^2))#1st row, 1st col"
"0","  result12 <- sum(mean((N*b1*b2)/(theta.old)^2))#1st row,2nd col"
"0","  result22 <- sum(mean((N*b2^2)/(theta.old)^2))#2nd row, 2nd col"
"0","  result21 <- sum(mean((N*b2*b1)/(theta.old)^2))#2nd row, 1st col"
"0","  output <- as.numeric(list(result11,result21,result12,result22))"
"0","  return(matrix(data = output, nrow = 2, ncol = 2, dimnames = NULL))"
"0","}"
"0","#Newton's Method"
"0","new.oil <- function(N,b1,b2,dl,d2l,tol){"
"0","  n <- length(N)"
"0","  i <- 1"
"0","  theta.old <- c(1,1)"
"0","  for(i in 1:n){"
"0","    theta.new = theta.old - dl(N,b1,b2,theta.old)/d2l(N,b1,b2,theta.old)"
"0","    if(abs(theta.new - theta.old) <= tol){"
"0","      output.new <- theta.new"
"0","      return(output.new)"
"0","    }"
"0","    theta.old <- theta.new"
"0","  }"
"0","}"
"0","#Fisher Information Approach"
"0","fish.oil <- function(N,b1,b2,dl,I,tol){"
"0","  n <- length(N)"
"0","  i <- 1"
"0","  theta.old <- c(1,1)"
"0","  for(i in 1:n){"
"0","    theta.new = theta.old + dl(N,b1,b2,theta.old)/I(N,b1,b2,theta.old)"
"0","    if(abs(a-a0) <= tol){"
"0","      output.fish <- theta.new"
"0","      return(output.fish)"
"0","    }"
"0","    theta.old <- theta.new"
"0","  }"
"0","}"
"0","#main body of code (i.e. no function definitions)"
"0","N <- data.oil$spills"
"0","b1 <- data.oil$importexport"
"0","b2 <- data.oil$domestic"
"0","output.new <- new.oil(N,b1,b2,dl,d2l,1e-5)"
"2","Error in dl(N, b1, b2, theta.old)/d2l(N, b1, b2, theta.old) : 
  non-conformable arrays
"
